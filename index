<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Inteligencia de Negocio - Farmacias</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        /* Estilos para el selector múltiple */
        .multiselect-container {
            position: relative;
        }
        .multiselect-options {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            max-height: 200px;
            overflow-y: auto;
            z-index: 10;
            width: 100%;
        }
        .multiselect-options.show {
            display: block;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">
    <div class="max-w-full mx-auto bg-white rounded-2xl shadow-lg p-6">
        <!-- Cabecera y Título -->
        <header class="mb-6">
            <h1 class="text-3xl font-bold text-slate-800">Dashboard de Rendimiento de Farmacias</h1>
            <p class="text-slate-500 mt-1">Visualiza, filtra y analiza los datos clave de tu red.</p>
        </header>

        <!-- Sección de Filtros -->
        <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 mb-8">
            <h2 class="text-xl font-semibold text-slate-700 mb-4">Filtros Avanzados</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                
                <!-- Filtro Farmacia -->
                <div class="multiselect-container">
                    <label for="farmacia-select" class="block text-sm font-medium text-slate-600 mb-1">Farmacia</label>
                    <div id="farmacia-select" class="w-full bg-white border border-slate-300 rounded-lg shadow-sm p-2 flex justify-between items-center cursor-pointer">
                        <span id="farmacia-selected-text" class="text-slate-700">Todas las farmacias</span>
                        <i data-lucide="chevron-down" class="h-5 w-5 text-slate-500"></i>
                    </div>
                    <div id="farmacia-options" class="multiselect-options mt-1">
                        <label class="block p-2 hover:bg-slate-100"><input type="checkbox" class="mr-2" value="all" checked> Todas</label>
                        <label class="block p-2 hover:bg-slate-100"><input type="checkbox" class="mr-2" value="f1"> Farmacia Sol</label>
                        <label class="block p-2 hover:bg-slate-100"><input type="checkbox" class="mr-2" value="f2"> Farmacia del Mar</label>
                        <label class="block p-2 hover:bg-slate-100"><input type="checkbox" class="mr-2" value="f3"> Farmacia Central</label>
                        <label class="block p-2 hover:bg-slate-100"><input type="checkbox" class="mr-2" value="f4"> Farmacia del Parque</label>
                    </div>
                </div>

                <!-- Filtro Gestor de Zona -->
                <div>
                    <label for="gestor" class="block text-sm font-medium text-slate-600 mb-1">Gestor de Zona</label>
                    <select id="gestor" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Todos los gestores</option>
                        <option>Ana García</option>
                        <option>Carlos Pérez</option>
                        <option>Laura Martínez</option>
                    </select>
                </div>

                <!-- Filtro Ubicación -->
                <div>
                    <label for="ubicacion" class="block text-sm font-medium text-slate-600 mb-1">Ubicación (CCAA)</label>
                    <select id="ubicacion" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Todas las CCAA</option>
                        <option>Andalucía</option>
                        <option>Comunidad de Madrid</option>
                        <option>Cataluña</option>
                        <option>Comunidad Valenciana</option>
                    </select>
                </div>
                
                <!-- Filtro Situación -->
                <div>
                    <label for="situacion" class="block text-sm font-medium text-slate-600 mb-1">Situación</label>
                    <select id="situacion" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Cualquier situación</option>
                        <option>En Implantación</option>
                        <option>En Desarrollo</option>
                    </select>
                </div>

                <!-- Filtro Rendimiento -->
                <div>
                    <label for="rendimiento" class="block text-sm font-medium text-slate-600 mb-1">Rendimiento</label>
                    <select id="rendimiento" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Todos</option>
                        <option>Por debajo facturación</option>
                        <option>Por debajo EBITDA</option>
                        <option>Debajo de ambos</option>
                    </select>
                </div>

                <!-- Filtro Categoria: Ventas -->
                <div>
                    <label for="ventas-categoria" class="block text-sm font-medium text-slate-600 mb-1">Categoría: Ventas</label>
                    <select id="ventas-categoria" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Todas</option>
                        <option>&lt; 1M €</option>
                        <option>&lt; 1.5M €</option>
                        <option>1.5M - 2.5M €</option>
                        <option>2.5M - 3.5M €</option>
                        <option>&gt; 3.5M €</option>
                    </select>
                </div>

                <!-- Filtro Categoria: Superficie -->
                <div>
                    <label for="superficie-categoria" class="block text-sm font-medium text-slate-600 mb-1">Categoría: Superficie</label>
                    <select id="superficie-categoria" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Todas</option>
                        <option>&lt; 100m²</option>
                        <option>100m² - 200m²</option>
                        <option>&gt; 300m²</option>
                    </select>
                </div>

                <!-- Filtro Categoria: Días Apertura -->
                <div>
                    <label for="dias-apertura" class="block text-sm font-medium text-slate-600 mb-1">Categoría: Días Apertura</label>
                    <select id="dias-apertura" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Cualquiera</option>
                        <option>365 días</option>
                        <option>Lunes a Sábado</option>
                        <option>Lunes a Viernes</option>
                    </select>
                </div>

                <!-- Filtro Categoria: Horas Apertura -->
                <div>
                    <label for="horas-apertura" class="block text-sm font-medium text-slate-600 mb-1">Categoría: Horas Apertura</label>
                    <select id="horas-apertura" class="w-full border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Cualquiera</option>
                        <option>24 horas</option>
                        <option>12 horas</option>
                    </select>
                </div>
            </div>
             <div class="flex justify-between items-center mt-4">
                <div>
                    <label for="agrupar" class="block text-sm font-medium text-slate-600 mb-1">Agrupar por</label>
                    <select id="agrupar" class="border-slate-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <option>Ninguna</option>
                        <option>Gestor de Zona</option>
                        <option>Comunidad Autónoma</option>
                        <option>Situación</option>
                    </select>
                </div>
                <button class="bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:bg-indigo-700 transition-colors">
                    Aplicar Filtros
                </button>
            </div>
        </div>

        <!-- Vista de Conceptos P&G -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
            
            <!-- Card: Ventas Brutas -->
            <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl flex flex-col">
                <h3 class="text-lg font-bold text-slate-800 mb-3">Ventas Brutas</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">1.25M€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-bold text-red-600 text-sm">1.18M€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-red-600 text-sm">2.83M€</p></div>
                </div>
                <hr class="my-3">
                <h4 class="font-semibold text-slate-700 mb-2 text-sm">Variables Clave</h4>
                <div class="space-y-3 flex-grow">
                    <div class="bg-white p-3 rounded-md border"><p class="font-semibold text-slate-800 text-sm">Ticket Medio</p><div class="text-xs space-y-1 mt-1"><p><strong>Impacto:</strong> <span class="text-red-500 font-semibold">-25k €</span></p><p><strong>Dispersión:</strong> <span class="font-mono">(3/5/4)</span></p><div class="flex justify-between font-mono pt-1"><span>Obj: 35.0€</span><span class="text-red-500">Real: 33.5€</span><span>Est: 33.8€</span></div></div></div>
                    <div class="bg-white p-3 rounded-md border"><p class="font-semibold text-slate-800 text-sm">Unidades por Ticket</p><div class="text-xs space-y-1 mt-1"><p><strong>Impacto:</strong> <span class="text-green-500 font-semibold">+5k €</span></p><p><strong>Dispersión:</strong> <span class="font-mono">(7/3/2)</span></p><div class="flex justify-between font-mono pt-1"><span>Obj: 2.8</span><span class="text-green-500">Real: 2.9</span><span>Est: 2.9</span></div></div></div>
                    <div class="bg-white p-3 rounded-md border"><p class="font-semibold text-slate-800 text-sm">Ventas Parafarmacia</p><div class="text-xs space-y-1 mt-1"><p><strong>Impacto:</strong> <span class="text-red-500 font-semibold">-50k €</span></p><p><strong>Dispersión:</strong> <span class="font-mono">(2/4/6)</span></p><div class="flex justify-between font-mono pt-1"><span>Obj: 312.5k€</span><span class="text-red-500">Real: 295k€</span><span>Est: 708k€</span></div></div></div>
                </div>
                <div class="mt-4"><a href="#" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 text-sm"><i data-lucide="file-text" class="h-4 w-4"></i>Plan de Acción</a></div>
            </div>

            <!-- Card: Ventas Netas -->
            <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl">
                <h3 class="text-lg font-bold text-slate-800 mb-3">Ventas Netas</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">1.20M€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-bold text-red-600 text-sm">1.13M€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-red-600 text-sm">2.72M€</p></div>
                </div>
                <hr class="my-3">
                <p class="text-sm text-slate-500 text-center py-4">Sin variables clave definidas.</p>
            </div>

            <!-- Card: Costes Brutos -->
            <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl">
                <h3 class="text-lg font-bold text-slate-800 mb-3">Costes Brutos</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">825k€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-semibold text-slate-600 text-sm">817k€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-slate-600 text-sm">1.96M€</p></div>
                </div>
                <hr class="my-3">
                 <p class="text-sm text-slate-500 text-center py-4">Sin variables clave definidas.</p>
            </div>

            <!-- Card: Margen Bruto -->
            <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl">
                <h3 class="text-lg font-bold text-slate-800 mb-3">Margen Bruto</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">375k€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-bold text-green-600 text-sm">384k€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-green-600 text-sm">920k€</p></div>
                </div>
                 <hr class="my-3">
                 <p class="text-sm text-slate-500 text-center py-4">No hay desviaciones significativas en las variables.</p>
            </div>

            <!-- Card: Costes -->
            <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl">
                <h3 class="text-lg font-bold text-slate-800 mb-3">Costes</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">250k€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-bold text-red-600 text-sm">274k€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-red-600 text-sm">656k€</p></div>
                </div>
                <hr class="my-3">
                <p class="text-sm text-slate-500 text-center py-4">Variables de costes agregadas en EBITDA.</p>
            </div>

            <!-- Card: EBITDA -->
             <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl flex flex-col">
                <h3 class="text-lg font-bold text-slate-800 mb-3">EBITDA</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">125k€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-bold text-red-600 text-sm">110k€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-red-600 text-sm">264k€</p></div>
                </div>
                <hr class="my-3">
                <h4 class="font-semibold text-slate-700 mb-2 text-sm">Variables Clave</h4>
                <div class="space-y-3 flex-grow">
                    <div class="bg-white p-3 rounded-md border"><p class="font-semibold text-slate-800 text-sm">Costes de Personal</p><div class="text-xs space-y-1 mt-1"><p><strong>Impacto:</strong> <span class="text-red-500 font-semibold">-12k €</span></p><p><strong>Dispersión:</strong> <span class="font-mono">(N/A)</span></p><div class="flex justify-between font-mono pt-1"><span>Obj: 150k€</span><span class="text-red-500">Real: 155k€</span><span>Est: 372k€</span></div></div></div>
                    <div class="bg-white p-3 rounded-md border"><p class="font-semibold text-slate-800 text-sm">Alquileres</p><div class="text-xs space-y-1 mt-1"><p><strong>Impacto:</strong> <span class="text-green-500 font-semibold">0 €</span></p><p><strong>Dispersión:</strong> <span class="font-mono">(N/A)</span></p><div class="flex justify-between font-mono pt-1"><span>Obj: 50k€</span><span class="text-green-500">Real: 50k€</span><span>Est: 120k€</span></div></div></div>
                </div>
                 <div class="mt-4"><a href="#" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 text-sm"><i data-lucide="file-text" class="h-4 w-4"></i>Plan de Acción</a></div>
            </div>

            <!-- Card: Flujo de Caja -->
            <div class="bg-slate-50 border border-slate-200 p-4 rounded-xl">
                <h3 class="text-lg font-bold text-slate-800 mb-3">Flujo de Caja</h3>
                <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                    <div><span class="text-xs text-slate-500">OBJETIVO</span><p class="font-mono font-semibold text-slate-600 text-sm">80k€</p></div>
                    <div><span class="text-xs text-slate-500">REAL</span><p class="font-mono font-bold text-green-600 text-sm">95k€</p></div>
                    <div><span class="text-xs text-slate-500">ESTIMADO</span><p class="font-mono font-semibold text-green-600 text-sm">228k€</p></div>
                </div>
                 <hr class="my-3">
                 <p class="text-sm text-slate-500 text-center py-4">No hay desviaciones significativas.</p>
            </div>

        </div>
    </div>

    <script>
        lucide.createIcons();

        // Lógica para el selector múltiple de farmacias
        const farmaciaSelect = document.getElementById('farmacia-select');
        const farmaciaOptions = document.getElementById('farmacia-options');
        const farmaciaSelectedText = document.getElementById('farmacia-selected-text');
        const farmaciaCheckboxes = farmaciaOptions.querySelectorAll('input[type="checkbox"]');

        farmaciaSelect.addEventListener('click', () => {
            farmaciaOptions.classList.toggle('show');
        });

        farmaciaCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const selected = Array.from(farmaciaCheckboxes)
                    .filter(c => c.checked && c.value !== 'all')
                    .map(c => c.parentElement.textContent.trim());
                
                if (checkbox.value === 'all') {
                    farmaciaCheckboxes.forEach(c => c.checked = checkbox.checked);
                } else {
                     document.querySelector('input[value="all"]').checked = false;
                }

                const allChecked = Array.from(farmaciaCheckboxes).every(c => c.checked) || document.querySelector('input[value="all"]').checked;

                if (allChecked || selected.length === 0) {
                     farmaciaSelectedText.textContent = 'Todas las farmacias';
                     document.querySelector('input[value="all"]').checked = true;
                } else if (selected.length === 1) {
                    farmaciaSelectedText.textContent = selected[0];
                } else {
                    farmaciaSelectedText.textContent = `${selected.length} farmacias seleccionadas`;
                }
            });
        });
        
        document.addEventListener('click', function(event) {
            if (!farmaciaSelect.contains(event.target) && !farmaciaOptions.contains(event.target)) {
                farmaciaOptions.classList.remove('show');
            }
        });
    </script>
</body>
</html>




